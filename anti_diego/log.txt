skipping token preprocessing for validation : using cache dataset/validation.pt
skipping token preprocessing for train : using cache dataset/train.pt
found 1 shards for split val
found 1 shards for split train
shuffled 466747279 tokens in 12.4s
using torch.compile
num non-decayed parameter tensors: 98, with 71,680 parameters
using fused AdamW: True
step     0 | loss 9.058255 | byte loss 2.2143 | lr 4.0000e-06 | norm 17.5366 | dt 17222.31ms | tok/sec: 3805.30 | ds 17.2s
step    10 | loss 8.174000 | byte loss 1.9982 | lr 4.4000e-05 | norm 2.8662 | dt 129.48ms | tok/sec: 506149.98 | ds 18.4s
step    20 | loss 7.395286 | byte loss 1.8078 | lr 8.4000e-05 | norm 2.9855 | dt 128.53ms | tok/sec: 509896.21 | ds 19.7s
step    30 | loss 6.678061 | byte loss 1.6325 | lr 1.2400e-04 | norm 2.4503 | dt 128.53ms | tok/sec: 509894.32 | ds 21.0s
step    40 | loss 5.944621 | byte loss 1.4532 | lr 1.6400e-04 | norm 1.6001 | dt 129.34ms | tok/sec: 506692.99 | ds 22.3s
step    50 | loss 5.277511 | byte loss 1.2901 | lr 2.0400e-04 | norm 1.3471 | dt 129.65ms | tok/sec: 505494.70 | ds 23.6s
step    60 | loss 4.784490 | byte loss 1.1696 | lr 2.4400e-04 | norm 0.8676 | dt 128.37ms | tok/sec: 510530.72 | ds 24.9s
step    70 | loss 4.475116 | byte loss 1.0940 | lr 2.8400e-04 | norm 1.1085 | dt 129.45ms | tok/sec: 506246.00 | ds 26.2s
step    80 | loss 4.274005 | byte loss 1.0448 | lr 3.2400e-04 | norm 1.2559 | dt 128.41ms | tok/sec: 510377.15 | ds 27.4s
step    90 | loss 4.146511 | byte loss 1.0136 | lr 3.6400e-04 | norm 1.1046 | dt 126.85ms | tok/sec: 516624.67 | ds 28.8s
step   100 | loss 4.045230 | byte loss 0.9889 | lr 4.0400e-04 | norm 1.1229 | dt 128.61ms | tok/sec: 509565.37 | ds 30.0s
step   110 | loss 3.977428 | byte loss 0.9723 | lr 4.4400e-04 | norm 0.7237 | dt 129.55ms | tok/sec: 505879.84 | ds 31.3s
step   120 | loss 3.913356 | byte loss 0.9566 | lr 4.8400e-04 | norm 0.8103 | dt 129.18ms | tok/sec: 507304.57 | ds 32.6s
step   130 | loss 3.848399 | byte loss 0.9408 | lr 5.2400e-04 | norm 1.0092 | dt 128.58ms | tok/sec: 509684.42 | ds 33.9s
step   140 | loss 3.787461 | byte loss 0.9259 | lr 5.6400e-04 | norm 1.0261 | dt 129.44ms | tok/sec: 506317.80 | ds 35.2s
step   150 | loss 3.732797 | byte loss 0.9125 | lr 6.0400e-04 | norm 0.9191 | dt 128.91ms | tok/sec: 508400.48 | ds 36.5s
step   160 | loss 3.658772 | byte loss 0.8944 | lr 6.4400e-04 | norm 1.0312 | dt 128.44ms | tok/sec: 510261.57 | ds 37.8s
step   170 | loss 3.572330 | byte loss 0.8733 | lr 6.8400e-04 | norm 1.1238 | dt 121.47ms | tok/sec: 539532.75 | ds 39.1s
step   180 | loss 3.482486 | byte loss 0.8513 | lr 7.2400e-04 | norm 0.9809 | dt 128.90ms | tok/sec: 508421.17 | ds 40.4s
step   190 | loss 3.423080 | byte loss 0.8368 | lr 7.6400e-04 | norm 1.1296 | dt 128.59ms | tok/sec: 509652.29 | ds 41.7s
step   200 | loss 3.356520 | byte loss 0.8205 | lr 8.0400e-04 | norm 0.9192 | dt 138.52ms | tok/sec: 473114.97 | ds 43.1s
step   210 | loss 3.298671 | byte loss 0.8064 | lr 8.4400e-04 | norm 0.6655 | dt 128.92ms | tok/sec: 508327.15 | ds 44.4s
step   220 | loss 3.214312 | byte loss 0.7858 | lr 8.8400e-04 | norm 0.7738 | dt 129.74ms | tok/sec: 505124.06 | ds 45.7s
step   230 | loss 3.161638 | byte loss 0.7729 | lr 9.2400e-04 | norm 0.9036 | dt 128.40ms | tok/sec: 510396.11 | ds 47.0s
step   240 | loss 3.110069 | byte loss 0.7603 | lr 9.6400e-04 | norm 0.7901 | dt 129.52ms | tok/sec: 505973.89 | ds 48.3s
step 250 | val loss 3.0322 | byte loss 0.7412 | ds 56.0s
step   250 | loss 3.028827 | byte loss 0.7404 | lr 1.0040e-03 | norm 0.7215 | dt 6625.81ms | tok/sec: 9891.02 | ds 56.1s
step   260 | loss 2.958948 | byte loss 0.7233 | lr 1.0440e-03 | norm 0.9676 | dt 130.38ms | tok/sec: 502645.84 | ds 57.4s
step   270 | loss 2.918344 | byte loss 0.7134 | lr 1.0840e-03 | norm 0.9357 | dt 137.05ms | tok/sec: 478190.74 | ds 58.7s
step   280 | loss 2.880994 | byte loss 0.7043 | lr 1.1240e-03 | norm 0.8722 | dt 130.30ms | tok/sec: 502967.74 | ds 60.0s
step   290 | loss 2.831485 | byte loss 0.6922 | lr 1.1640e-03 | norm 0.7720 | dt 132.01ms | tok/sec: 496449.99 | ds 61.3s
step   300 | loss 2.773570 | byte loss 0.6780 | lr 1.2040e-03 | norm 0.5994 | dt 131.15ms | tok/sec: 499697.15 | ds 62.6s
step   310 | loss 2.732668 | byte loss 0.6680 | lr 1.2440e-03 | norm 0.6509 | dt 129.91ms | tok/sec: 504462.17 | ds 63.9s
step   320 | loss 2.682562 | byte loss 0.6558 | lr 1.2840e-03 | norm 0.7408 | dt 121.31ms | tok/sec: 540229.41 | ds 65.2s
step   330 | loss 2.678926 | byte loss 0.6549 | lr 1.3240e-03 | norm 0.6408 | dt 140.18ms | tok/sec: 467498.52 | ds 66.5s
step   340 | loss 2.611997 | byte loss 0.6385 | lr 1.3640e-03 | norm 0.5764 | dt 130.67ms | tok/sec: 501556.26 | ds 67.8s
step   350 | loss 2.597452 | byte loss 0.6350 | lr 1.4040e-03 | norm 0.7275 | dt 120.60ms | tok/sec: 543410.95 | ds 69.1s
step   360 | loss 2.583124 | byte loss 0.6315 | lr 1.4440e-03 | norm 0.9093 | dt 128.34ms | tok/sec: 510661.60 | ds 70.4s
step   370 | loss 2.541873 | byte loss 0.6214 | lr 1.4840e-03 | norm 0.5508 | dt 130.49ms | tok/sec: 502242.65 | ds 71.7s
step   380 | loss 2.498730 | byte loss 0.6108 | lr 1.5240e-03 | norm 0.5823 | dt 131.45ms | tok/sec: 498557.91 | ds 73.1s
step   390 | loss 2.459393 | byte loss 0.6012 | lr 1.5640e-03 | norm 0.6037 | dt 128.07ms | tok/sec: 511723.50 | ds 74.4s
step   400 | loss 2.442051 | byte loss 0.5970 | lr 1.6040e-03 | norm 0.5551 | dt 127.57ms | tok/sec: 513740.55 | ds 75.7s
step   410 | loss 2.407638 | byte loss 0.5886 | lr 1.6440e-03 | norm 0.5297 | dt 129.85ms | tok/sec: 504711.34 | ds 77.0s
step   420 | loss 2.393765 | byte loss 0.5852 | lr 1.6840e-03 | norm 0.6519 | dt 130.35ms | tok/sec: 502786.50 | ds 78.3s
step   430 | loss 2.392532 | byte loss 0.5849 | lr 1.7240e-03 | norm 0.5322 | dt 130.06ms | tok/sec: 503882.36 | ds 79.6s
step   440 | loss 2.358731 | byte loss 0.5766 | lr 1.7640e-03 | norm 0.5493 | dt 124.36ms | tok/sec: 526981.77 | ds 80.9s
step   450 | loss 2.349246 | byte loss 0.5743 | lr 1.8040e-03 | norm 0.5647 | dt 121.33ms | tok/sec: 540140.24 | ds 82.2s
step   460 | loss 2.342109 | byte loss 0.5725 | lr 1.8440e-03 | norm 0.5845 | dt 129.52ms | tok/sec: 506010.22 | ds 83.5s
step   470 | loss 2.321238 | byte loss 0.5674 | lr 1.8840e-03 | norm 0.5287 | dt 129.97ms | tok/sec: 504253.95 | ds 84.8s
step   480 | loss 2.284263 | byte loss 0.5584 | lr 1.9240e-03 | norm 0.4979 | dt 130.77ms | tok/sec: 501166.70 | ds 86.1s
step   490 | loss 2.276049 | byte loss 0.5564 | lr 1.9640e-03 | norm 0.4844 | dt 131.03ms | tok/sec: 500148.12 | ds 87.4s
step 500 | val loss 2.2765 | byte loss 0.5565 | ds 89.3s
step   500 | loss 2.246203 | byte loss 0.5491 | lr 2.0000e-03 | norm 0.5783 | dt 738.31ms | tok/sec: 88764.61 | ds 89.3s
step   510 | loss 2.238529 | byte loss 0.5472 | lr 2.0000e-03 | norm 0.4527 | dt 130.39ms | tok/sec: 502597.13 | ds 90.6s
step   520 | loss 2.235378 | byte loss 0.5465 | lr 2.0000e-03 | norm 0.4279 | dt 128.86ms | tok/sec: 508573.56 | ds 91.9s
step   530 | loss 2.183270 | byte loss 0.5337 | lr 2.0000e-03 | norm 0.4641 | dt 120.20ms | tok/sec: 545239.05 | ds 93.2s
step   540 | loss 2.200681 | byte loss 0.5380 | lr 2.0000e-03 | norm 0.5615 | dt 130.08ms | tok/sec: 503816.79 | ds 94.5s
step   550 | loss 2.157975 | byte loss 0.5275 | lr 2.0000e-03 | norm 0.4055 | dt 130.75ms | tok/sec: 501247.12 | ds 95.8s
step   560 | loss 2.168106 | byte loss 0.5300 | lr 2.0000e-03 | norm 0.4077 | dt 120.26ms | tok/sec: 544935.32 | ds 97.1s
step   570 | loss 2.130616 | byte loss 0.5208 | lr 2.0000e-03 | norm 0.4145 | dt 129.79ms | tok/sec: 504921.79 | ds 98.5s
step   580 | loss 2.110828 | byte loss 0.5160 | lr 2.0000e-03 | norm 0.4272 | dt 128.51ms | tok/sec: 509972.83 | ds 99.8s
step   590 | loss 2.097724 | byte loss 0.5128 | lr 2.0000e-03 | norm 0.3753 | dt 130.21ms | tok/sec: 503297.43 | ds 101.1s
step   600 | loss 2.091221 | byte loss 0.5112 | lr 2.0000e-03 | norm 0.5888 | dt 131.03ms | tok/sec: 500170.87 | ds 102.4s
step   610 | loss 2.100141 | byte loss 0.5134 | lr 2.0000e-03 | norm 0.3858 | dt 131.44ms | tok/sec: 498584.13 | ds 103.7s
step   620 | loss 2.077487 | byte loss 0.5079 | lr 2.0000e-03 | norm 0.3929 | dt 128.80ms | tok/sec: 508835.28 | ds 105.0s
step   630 | loss 2.063286 | byte loss 0.5044 | lr 2.0000e-03 | norm 0.3954 | dt 130.56ms | tok/sec: 501951.00 | ds 106.3s
step   640 | loss 2.056011 | byte loss 0.5026 | lr 2.0000e-03 | norm 0.4585 | dt 130.21ms | tok/sec: 503313.10 | ds 107.6s
step   650 | loss 2.057251 | byte loss 0.5029 | lr 2.0000e-03 | norm 0.3789 | dt 132.07ms | tok/sec: 496229.52 | ds 108.9s
step   660 | loss 2.035726 | byte loss 0.4976 | lr 2.0000e-03 | norm 0.3816 | dt 128.72ms | tok/sec: 509136.87 | ds 110.2s
step   670 | loss 2.034743 | byte loss 0.4974 | lr 2.0000e-03 | norm 0.4124 | dt 140.31ms | tok/sec: 467083.05 | ds 111.5s
step   680 | loss 2.029926 | byte loss 0.4962 | lr 2.0000e-03 | norm 0.3772 | dt 130.89ms | tok/sec: 500696.56 | ds 112.9s
step   690 | loss 2.013499 | byte loss 0.4922 | lr 2.0000e-03 | norm 0.3852 | dt 129.70ms | tok/sec: 505287.48 | ds 114.2s
step   700 | loss 2.009261 | byte loss 0.4912 | lr 2.0000e-03 | norm 0.4070 | dt 131.57ms | tok/sec: 498092.65 | ds 115.5s
step   710 | loss 2.004929 | byte loss 0.4901 | lr 2.0000e-03 | norm 0.3611 | dt 131.20ms | tok/sec: 499497.39 | ds 116.8s
step   720 | loss 1.994293 | byte loss 0.4875 | lr 2.0000e-03 | norm 0.4473 | dt 129.88ms | tok/sec: 504570.52 | ds 118.1s
step   730 | loss 1.987102 | byte loss 0.4858 | lr 2.0000e-03 | norm 0.3574 | dt 129.94ms | tok/sec: 504366.83 | ds 119.4s
step   740 | loss 1.968928 | byte loss 0.4813 | lr 2.0000e-03 | norm 0.3175 | dt 129.62ms | tok/sec: 505594.18 | ds 120.7s
step 750 | val loss 2.0011 | byte loss 0.4892 | ds 122.6s
step   750 | loss 1.969396 | byte loss 0.4814 | lr 2.0000e-03 | norm 0.3853 | dt 743.81ms | tok/sec: 88108.42 | ds 122.6s
step   760 | loss 1.954637 | byte loss 0.4778 | lr 2.0000e-03 | norm 0.3209 | dt 131.18ms | tok/sec: 499588.17 | ds 123.9s
step   770 | loss 1.970889 | byte loss 0.4818 | lr 2.0000e-03 | norm 0.3309 | dt 134.08ms | tok/sec: 488794.36 | ds 125.3s
step   780 | loss 1.948697 | byte loss 0.4764 | lr 2.0000e-03 | norm 0.3398 | dt 129.94ms | tok/sec: 504344.62 | ds 126.6s
step   790 | loss 1.932356 | byte loss 0.4724 | lr 2.0000e-03 | norm 0.3296 | dt 129.99ms | tok/sec: 504170.71 | ds 127.9s
step   800 | loss 1.934882 | byte loss 0.4730 | lr 2.0000e-03 | norm 0.3682 | dt 121.43ms | tok/sec: 539702.24 | ds 129.2s
